zabbix_export:
  version: '7.0'
  template_groups:
  - uuid: 846977d1dfed4968bc5f8bdb363285bc
    name: Templates/Operating systems
  templates:
  - uuid: a37ceac55e06444f9e66377efd064c15
    template: Vsat by SNMP
    name: Vsat by SNMP
    description: |
      This is an official Linux template. It requires an SNMP client.

      MIBs used:
      EtherLike-MIB
      HOST-RESOURCES-MIB
      SNMPv2-MIB
      UCD-DISKIO-MIB
      UCD-SNMP-MIB
      IF-MIB

      Notes on filesystem (FS) discovery:
        - The ext4/3/2 FS reserves space for privileged usage, typically set at 5% by default.
        - BTRFS allocates a default of 10% of the volume for its own needs.
        - To mitigate potential disasters, FS usage triggers are based on the maximum available space.
          - Utilization formula: 'pused = 100 * (used / used + available)'
        - The FS utilization chart, derived from graph prototypes, reflects FS reserved space as the difference between used and available space from the total volume.

      You can discuss this template or leave feedback on our forum https://www.zabbix.com/forum/zabbix-suggestions-and-feedback/387225-discussion-thread-for-official-zabbix-template-for-linux

      Generated by official Zabbix template tool "Templator"
    groups:
    - name: Templates/Operating systems
    items:
    - uuid: 3c0bf6123fc8414cba56b818ec12543d
      name: ICMP ping
      type: SIMPLE
      key: icmpping
      history: 7d
      valuemap:
        name: Service state
      tags:
      - tag: component
        value: health
      - tag: component
        value: network
      triggers:
      - uuid: 852653a2762d4ff0a90bed8da5f09369
        expression: max(/Vsat by SNMP/icmpping,#3)=0
        name: Unavailable by ICMP ping
        priority: HIGH
        description: Last three attempts returned timeout.  Please check device connectivity.
        tags:
        - tag: scope
          value: availability
    - uuid: 1814cd8f62a8425896274313be029544
      name: ICMP loss
      type: SIMPLE
      key: icmppingloss
      history: 7d
      value_type: FLOAT
      units: '%'
      tags:
      - tag: component
        value: health
      - tag: component
        value: network
      triggers:
      - uuid: 290b25b4d0944761aadf0ec8f91cc2cb
        expression: min(/Vsat by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Vsat
          by SNMP/icmppingloss,5m)<100
        name: High ICMP ping loss
        opdata: 'Loss: {ITEM.LASTVALUE1}'
        priority: WARNING
        dependencies:
        - name: Unavailable by ICMP ping
          expression: max(/Vsat by SNMP/icmpping,#3)=0
        tags:
        - tag: scope
          value: availability
        - tag: scope
          value: performance
    - uuid: c4cb4c739f484b48abf30adcba2c2e3d
      name: ICMP response time
      type: SIMPLE
      key: icmppingsec
      history: 7d
      value_type: FLOAT
      units: s
      tags:
      - tag: component
        value: health
      - tag: component
        value: network
      triggers:
      - uuid: 4d963cd931504970bdb9a59019380fc0
        expression: avg(/Vsat by SNMP/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}
        name: High ICMP ping response time
        opdata: 'Value: {ITEM.LASTVALUE1}'
        priority: WARNING
        description: Average ICMP response time is too high.
        dependencies:
        - name: High ICMP ping loss
          expression: min(/Vsat by SNMP/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Vsat
            by SNMP/icmppingloss,5m)<100
        - name: Unavailable by ICMP ping
          expression: max(/Vsat by SNMP/icmpping,#3)=0
        tags:
        - tag: scope
          value: availability
        - tag: scope
          value: performance
    - uuid: 1005b733ab574a6d922a8461753ea305
      name: 'Linux: SNMP walk EtherLike-MIB interfaces'
      type: SNMP_AGENT
      snmp_oid: 
        walk[1.3.6.1.2.1.10.7.2.1.19,1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2]
      key: net.if.duplex.walk
      history: '0'
      value_type: TEXT
      trends: '0'
      status: DISABLED
      description: Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces
        with `up(1)` Operational Status are discovered.
      timeout: 30s
      tags:
      - tag: component
        value: raw
    - uuid: a49a12162e254da5af2b3cc14138a845
      name: 'Linux: SNMP walk network interfaces'
      type: SNMP_AGENT
      snmp_oid: 
        walk[1.3.6.1.2.1.2.2.1.8,1.3.6.1.2.1.2.2.1.7,1.3.6.1.2.1.31.1.1.1.18,1.3.6.1.2.1.31.1.1.1.1,1.3.6.1.2.1.2.2.1.2,1.3.6.1.2.1.2.2.1.3,1.3.6.1.2.1.31.1.1.1.6,1.3.6.1.2.1.31.1.1.1.10,1.3.6.1.2.1.2.2.1.14,1.3.6.1.2.1.2.2.1.20,1.3.6.1.2.1.2.2.1.19,1.3.6.1.2.1.2.2.1.13,1.3.6.1.2.1.31.1.1.1.15]
      key: net.if.walk
      history: '0'
      value_type: TEXT
      trends: '0'
      status: DISABLED
      description: Discovering interfaces from IF-MIB.
      timeout: 30s
      tags:
      - tag: component
        value: raw
    - uuid: 0fa4f5fe83594f0da726ce5da92aa593
      name: SNMP traps (fallback)
      type: SNMP_TRAP
      key: snmptrap.fallback
      delay: '0'
      history: 7d
      value_type: LOG
      trends: '0'
      status: DISABLED
      description: The item is used to collect all SNMP traps unmatched by other snmptrap
        items
      logtimefmt: hh:mm:sszyyyy/MM/dd
      tags:
      - tag: component
        value: network
    - uuid: 0c795af918e54901927fe50205a3d140
      name: System contact details
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.4.0
      key: system.contact[sysContact.0]
      delay: 15m
      history: 7d
      value_type: CHAR
      trends: '0'
      status: DISABLED
      description: |
        MIB: SNMPv2-MIB
        The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
      inventory_link: CONTACT
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: component
        value: system
    - uuid: f125d1f26dd9419db2ca8b6e21605eb2
      name: Interrupts per second
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.11.59.0
      key: system.cpu.intr[ssRawInterrupts.0]
      history: 7d
      value_type: FLOAT
      status: DISABLED
      description: Number of interrupts processed.
      preprocessing:
      - type: CHANGE_PER_SECOND
        parameters:
        - ''
      tags:
      - tag: component
        value: cpu
    - uuid: 63fccb4132c5475f92fbb21144e553a7
      name: Load average (1m avg)
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.10.1.3["index","1.3.6.1.4.1.2021.10.1.2", "Load-1"]
      key: system.cpu.load.avg1[laLoad.1]
      history: 7d
      value_type: FLOAT
      status: DISABLED
      description: 'MIB: UCD-SNMP-MIB'
      tags:
      - tag: component
        value: cpu
    - uuid: 23aecef636f94685b00f4d2605139377
      name: Load average (5m avg)
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.10.1.3["index","1.3.6.1.4.1.2021.10.1.2", "Load-5"]
      key: system.cpu.load.avg5[laLoad.2]
      history: 7d
      value_type: FLOAT
      status: DISABLED
      description: 'MIB: UCD-SNMP-MIB'
      tags:
      - tag: component
        value: cpu
    - uuid: 04bdf39f3def43d786dca617f274405a
      name: Load average (15m avg)
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.10.1.3["index","1.3.6.1.4.1.2021.10.1.2", "Load-15"]
      key: system.cpu.load.avg15[laLoad.3]
      history: 7d
      value_type: FLOAT
      status: DISABLED
      description: 'MIB: UCD-SNMP-MIB'
      tags:
      - tag: component
        value: cpu
    - uuid: 8dac7bb30644414db16d27475a958675
      name: Number of CPUs
      type: DEPENDENT
      key: system.cpu.num[snmp]
      delay: '0'
      history: 7d
      status: DISABLED
      description: Count the number of CPU cores by counting number of cores discovered
        in hrProcessorTable using LLD.
      preprocessing:
      - type: SNMP_WALK_TO_JSON
        parameters:
        - '{#SNMPVALUE}'
        - 1.3.6.1.2.1.25.3.3.1.1
        - '0'
      - type: JAVASCRIPT
        parameters:
        - return JSON.parse(value).length;
      master_item:
        key: system.cpu.walk
      tags:
      - tag: component
        value: cpu
    - uuid: bf1dca6d007f442ca7f010df6e50d3a3
      name: Context switches per second
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.11.60.0
      key: system.cpu.switches[ssRawContexts.0]
      history: 7d
      value_type: FLOAT
      status: DISABLED
      description: The combined rate at which all processors on the computer are switched
        from one thread to another.
      preprocessing:
      - type: CHANGE_PER_SECOND
        parameters:
        - ''
      tags:
      - tag: component
        value: cpu
    - uuid: 4fad21ea243b4fe995f274672342eb83
      name: SNMP walk system CPUs
      type: SNMP_AGENT
      snmp_oid: 
        walk[1.3.6.1.2.1.25.3.3.1.1,1.3.6.1.4.1.2021.11.53.0,1.3.6.1.4.1.2021.11.52.0,1.3.6.1.4.1.2021.11.50.0,1.3.6.1.4.1.2021.11.64.0,1.3.6.1.4.1.2021.11.61.0,1.3.6.1.4.1.2021.11.51.0,1.3.6.1.4.1.2021.11.54.0,1.3.6.1.4.1.2021.11.56.0,1.3.6.1.4.1.2021.11.65.0,1.3.6.1.4.1.2021.11.66.0]
      key: system.cpu.walk
      history: '0'
      value_type: TEXT
      trends: '0'
      status: DISABLED
      description: |
        MIB: HOST-RESOURCES-MIB
        Discovering system CPUs.
      timeout: 30s
      tags:
      - tag: component
        value: raw
    - uuid: 99ae53334eda439cb5cee52601d65214
      name: System description
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.1.0
      key: system.descr[sysDescr.0]
      delay: 15m
      history: 7d
      value_type: CHAR
      trends: '0'
      status: DISABLED
      description: |
        MIB: SNMPv2-MIB
        A textual description of the entity. This value should
        include the full name and version identification of the system's hardware type, software operating-system, and
        networking software.
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: component
        value: system
    - uuid: a46d5eade4a943b9b728644bec9fdae6
      name: Uptime (hardware)
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.25.1.1.0
      key: system.hw.uptime[hrSystemUptime.0]
      delay: 30s
      history: 7d
      trends: '0'
      status: DISABLED
      units: uptime
      description: |
        MIB: HOST-RESOURCES-MIB
        The amount of time since this host was last initialized. Note that this is different from sysUpTime in the SNMPv2-MIB [RFC1907] because sysUpTime is the uptime of the network management portion of the system.
      preprocessing:
      - type: CHECK_NOT_SUPPORTED
        parameters:
        - '-1'
        error_handler: CUSTOM_VALUE
        error_handler_params: '0'
      - type: MULTIPLIER
        parameters:
        - '0.01'
      tags:
      - tag: component
        value: system
    - uuid: a81c8ecc6b8f4c938859a27bacebab6e
      name: System location
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.6.0
      key: system.location[sysLocation.0]
      delay: 15m
      history: 7d
      value_type: CHAR
      trends: '0'
      status: DISABLED
      description: |
        MIB: SNMPv2-MIB
        Physical location of the node (e.g., `equipment room`, `3rd floor`). If not provided, the value is a zero-length string.
      inventory_link: LOCATION
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: component
        value: system
    - uuid: 8d8504c3451b4b8e8eea5015e92b7d79
      name: System name
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.5.0
      key: system.name
      delay: 15m
      history: 7d
      value_type: CHAR
      trends: '0'
      status: DISABLED
      description: |
        MIB: SNMPv2-MIB
        An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
      inventory_link: NAME
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: component
        value: system
      triggers:
      - uuid: 03ad4d19c5d64a619f65ad681f49524b
        expression: last(/Vsat by SNMP/system.name,#1)<>last(/Vsat by SNMP/system.name,#2)
          and length(last(/Vsat by SNMP/system.name))>0
        name: System name has changed
        event_name: 'System name has changed (new name: {ITEM.VALUE})'
        priority: INFO
        description: The name of the system has changed. Acknowledge to close the
          problem manually.
        manual_close: YES
        tags:
        - tag: scope
          value: notice
        - tag: scope
          value: security
    - uuid: c5d85c7ff5154eb78cb59298137e1750
      name: Uptime (network)
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.3.0
      key: system.net.uptime[sysUpTime.0]
      delay: 900s
      history: 7d
      trends: '0'
      units: uptime
      description: |
        MIB: SNMPv2-MIB
        Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '0.01'
      tags:
      - tag: component
        value: system
    - uuid: 4de808439f7440c5b19d9d6e39749c38
      name: System object ID
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.2.1.1.2.0
      key: system.objectid[sysObjectID.0]
      delay: 15m
      history: 7d
      value_type: CHAR
      trends: '0'
      status: DISABLED
      description: |
        MIB: SNMPv2-MIB
        The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
      preprocessing:
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 12h
      tags:
      - tag: component
        value: system
    - uuid: b44563ffb61147979e97b3530519c190
      name: Free swap space
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.4.4.0
      key: system.swap.free[memAvailSwap.0]
      history: 7d
      status: DISABLED
      units: B
      description: |
        MIB: UCD-SNMP-MIB
        The amount of swap space currently unused or available.
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '1024'
      tags:
      - tag: component
        value: memory
      - tag: component
        value: storage
    - uuid: 642c7cb60d11488697168d05570891df
      name: Free swap space in %
      type: CALCULATED
      key: system.swap.pfree[snmp]
      history: 7d
      value_type: FLOAT
      status: DISABLED
      units: '%'
      params: 
        last(//system.swap.free[memAvailSwap.0])/last(//system.swap.total[memTotalSwap.0])*100
      description: The free space of the swap volume/file expressed in %.
      tags:
      - tag: component
        value: memory
      - tag: component
        value: storage
    - uuid: d2ae06a05ab946faa7da900992eebf74
      name: Total swap space
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.4.3.0
      key: system.swap.total[memTotalSwap.0]
      history: 7d
      status: DISABLED
      units: B
      description: |
        MIB: UCD-SNMP-MIB
        The total amount of swap space configured for this host.
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '1024'
      tags:
      - tag: component
        value: memory
      - tag: component
        value: storage
    - uuid: 765f43651d394296876bdd4ec8f72118
      name: SNMP walk block devices
      type: SNMP_AGENT
      snmp_oid: 
        walk[1.3.6.1.4.1.2021.13.15.1.1.2,1.3.6.1.4.1.2021.13.15.1.1.5,1.3.6.1.4.1.2021.13.15.1.1.6,1.3.6.1.4.1.2021.13.15.1.1.9]
      key: vfs.dev.walk
      history: '0'
      value_type: TEXT
      trends: '0'
      status: DISABLED
      description: Block devices are discovered from UCD-DISKIO-MIB::diskIOTable (http://net-snmp.sourceforge.net/docs/mibs/ucdDiskIOMIB.html#diskIOTable).
      timeout: 30s
      tags:
      - tag: component
        value: raw
    - uuid: 396fcca7545f465dbe817a25e74e53a4
      name: SNMP walk mounted filesystems
      type: SNMP_AGENT
      snmp_oid: 
        walk[1.3.6.1.4.1.2021.9.1.1,1.3.6.1.4.1.2021.9.1.2,1.3.6.1.4.1.2021.9.1.3,1.3.6.1.4.1.2021.9.1.10,1.3.6.1.4.1.2021.9.1.11,1.3.6.1.4.1.2021.9.1.12,1.3.6.1.4.1.2021.9.1.13,1.3.6.1.4.1.2021.9.1.14,1.3.6.1.4.1.2021.9.1.15,1.3.6.1.4.1.2021.9.1.16]
      key: vfs.fs.walk
      history: '0'
      value_type: TEXT
      trends: '0'
      status: DISABLED
      description: |
        MIB: UCD-SNMP-MIB
        Snmp walk through dskEntry table. Collected data used in filesystem lld and dependent item prototypes.
      preprocessing:
      - type: SNMP_WALK_TO_JSON
        parameters:
        - dskPath
        - 1.3.6.1.4.1.2021.9.1.2
        - '0'
        - dskDevice
        - 1.3.6.1.4.1.2021.9.1.3
        - '0'
        - dskPercentNode
        - 1.3.6.1.4.1.2021.9.1.10
        - '0'
        - dskTotalLow
        - 1.3.6.1.4.1.2021.9.1.11
        - '0'
        - dskTotalHigh
        - 1.3.6.1.4.1.2021.9.1.12
        - '0'
        - dskAvailLow
        - 1.3.6.1.4.1.2021.9.1.13
        - '0'
        - dskAvailHigh
        - 1.3.6.1.4.1.2021.9.1.14
        - '0'
        - dskUsedLow
        - 1.3.6.1.4.1.2021.9.1.15
        - '0'
        - dskUsedHigh
        - 1.3.6.1.4.1.2021.9.1.16
        - '0'
        - dskEntry
        - 1.3.6.1.4.1.2021.9.1.1
        - '0'
      timeout: 30s
      tags:
      - tag: component
        value: raw
      - tag: component
        value: storage
    - uuid: 202f10f34f2245bda1c5a8278cfe7a3b
      name: Available memory
      type: CALCULATED
      key: vm.memory.available[snmp]
      history: 7d
      status: DISABLED
      units: B
      params: 
        last(//vm.memory.free[memAvailReal.0])+last(//vm.memory.buffers[memBuffer.0])+last(//vm.memory.cached[memCached.0])
      description: Please note that memory utilization is a rough estimate, since
        memory available is calculated as free+buffers+cached, which is not 100% accurate,
        but the best we can get using SNMP.
      tags:
      - tag: component
        value: memory
    - uuid: 783c3ca794744dc6af46be7a2f892e1f
      name: Memory (buffers)
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.4.14.0
      key: vm.memory.buffers[memBuffer.0]
      history: 7d
      status: DISABLED
      units: B
      description: |
        MIB: UCD-SNMP-MIB
        Memory used by kernel buffers (Buffers in /proc/meminfo).
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '1024'
      tags:
      - tag: component
        value: memory
    - uuid: 180bb3329ccd4c50af20303cf24df06f
      name: Memory (cached)
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.4.15.0
      key: vm.memory.cached[memCached.0]
      history: 7d
      status: DISABLED
      units: B
      description: |
        MIB: UCD-SNMP-MIB
        Memory used by the page cache and slabs (Cached and Slab in /proc/meminfo).
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '1024'
      tags:
      - tag: component
        value: memory
    - uuid: 341149d4065446928337e6c9bddd8a46
      name: Free memory
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.4.6.0
      key: vm.memory.free[memAvailReal.0]
      history: 7d
      status: DISABLED
      units: B
      description: 'MIB: UCD-SNMP-MIB'
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '1024'
      tags:
      - tag: component
        value: memory
    - uuid: 5be522095c4840b299a85a1caa29d651
      name: Total memory
      type: SNMP_AGENT
      snmp_oid: 1.3.6.1.4.1.2021.4.5.0
      key: vm.memory.total[memTotalReal.0]
      history: 7d
      status: DISABLED
      units: B
      description: |
        MIB: UCD-SNMP-MIB
        Total memory expressed in bytes.
      preprocessing:
      - type: MULTIPLIER
        parameters:
        - '1024'
      tags:
      - tag: component
        value: memory
    - uuid: 78777535717f4566ad22ac9ec60c4b97
      name: Memory utilization
      type: CALCULATED
      key: vm.memory.util[snmp]
      history: 7d
      value_type: FLOAT
      status: DISABLED
      units: '%'
      params: 
        (last(//vm.memory.total[memTotalReal.0])-(last(//vm.memory.free[memAvailReal.0])+last(//vm.memory.buffers[memBuffer.0])+last(//vm.memory.cached[memCached.0])))/last(//vm.memory.total[memTotalReal.0])*100
      description: Please note that memory utilization is a rough estimate, since
        memory available is calculated as free+buffers+cached, which is not 100% accurate,
        but the best we can get using SNMP.
      tags:
      - tag: component
        value: memory
    - uuid: fe8bf7b600514b6d83cfcb8b179e9af4
      name: SNMP agent availability
      type: INTERNAL
      key: zabbix[host,snmp,available]
      history: 7d
      status: DISABLED
      description: |
        Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
        Possible values:
        0 - not available
        1 - available
        2 - unknown
      valuemap:
        name: zabbix.host.available
      tags:
      - tag: component
        value: health
      - tag: component
        value: network
    discovery_rules:
    - uuid: 32b50adc116642b5b0f50f147b9eccfa
      name: CPU discovery
      type: DEPENDENT
      key: cpu.discovery[snmp]
      delay: '0'
      description: This discovery will create set of per core CPU metrics from UCD-SNMP-MIB,
        using {#CPU.COUNT} in preprocessing. That's the only reason why LLD is used.
      item_prototypes:
      - uuid: f4f7831bfa0c4a55ac19e1b943b7d3e1
        name: CPU guest time
        type: DEPENDENT
        key: system.cpu.guest[ssCpuRawGuest.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time spent on running a virtual CPU for a guest operating system.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.65.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: e368b0c06962412eaad623312489d168
        name: CPU guest nice time
        type: DEPENDENT
        key: system.cpu.guest_nice[ssCpuRawGuestNice.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time spent on running a niced guest (a virtual CPU for guest operating systems under the control of the Linux kernel).
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.66.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: 676cb01747054e7e88269e11155153fb
        name: CPU idle time
        type: DEPENDENT
        key: system.cpu.idle[ssCpuRawIdle.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time the CPU has spent doing nothing.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.53.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: ace15b95740b4b88b81589d041eedc4f
        name: CPU interrupt time
        type: DEPENDENT
        key: system.cpu.interrupt[ssCpuRawInterrupt.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time the CPU has spent servicing hardware interrupts.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.56.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: d772138274a74b99bd7e89e4c0aa6516
        name: CPU iowait time
        type: DEPENDENT
        key: system.cpu.iowait[ssCpuRawWait.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time the CPU has been waiting for I/O to complete.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.54.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: 97dc04011b404e5f9a5d0fc092ac60d9
        name: CPU nice time
        type: DEPENDENT
        key: system.cpu.nice[ssCpuRawNice.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time the CPU has spent running users' processes that have been niced.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.51.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: 9969f3d248644915b6514302ac917a69
        name: CPU softirq time
        type: DEPENDENT
        key: system.cpu.softirq[ssCpuRawSoftIRQ.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time the CPU has been servicing software interrupts.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.61.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: 8d371cf3e97843d09c0e4983baf053f3
        name: CPU steal time
        type: DEPENDENT
        key: system.cpu.steal[ssCpuRawSteal.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          The amount of "stolen" CPU from this virtual machine by the hypervisor for other tasks, such as running another virtual machine.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.64.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: 269ac98a8194455994ab3e8d3ec0f7c2
        name: CPU system time
        type: DEPENDENT
        key: system.cpu.system[ssCpuRawSystem.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time the CPU has spent running the kernel and its processes.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.52.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: c20f580df0e648d4a18948703439440c
        name: CPU user time
        type: DEPENDENT
        key: system.cpu.user[ssCpuRawUser.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Time the CPU has spent running users' processes that are not niced.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.11.50.0
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: JAVASCRIPT
          parameters:
          - return value/{#CPU.COUNT}
        master_item:
          key: system.cpu.walk
        tags:
        - tag: component
          value: cpu
      - uuid: 7b0eb5bb500a49e890b23d49f18d6fe8
        name: CPU utilization
        type: DEPENDENT
        key: system.cpu.util[snmp,{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: CPU utilization expressed in %.
        preprocessing:
        - type: JAVASCRIPT
          parameters:
          - return (100 - value)
        master_item:
          key: system.cpu.idle[ssCpuRawIdle.{#SNMPINDEX}]
        tags:
        - tag: component
          value: cpu
        trigger_prototypes:
        - uuid: 8034a257e9934140a42c4ec9681a853a
          expression: min(/Vsat by SNMP/system.cpu.util[snmp,{#SNMPINDEX}],5m)>{$CPU.UTIL.CRIT}
          name: High CPU utilization
          event_name: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)
          opdata: 'Current utilization: {ITEM.LASTVALUE1}'
          priority: WARNING
          description: CPU utilization is too high. The system might be slow to respond.
          tags:
          - tag: scope
            value: performance
      graph_prototypes:
      - uuid: a57e8422db264d87a513fc816d01e34c
        name: 'Linux: CPU usage{#SINGLETON}'
        type: STACKED
        ymin_type_1: FIXED
        ymax_type_1: FIXED
        graph_items:
        - color: 199C0D
          item:
            host: Vsat by SNMP
            key: system.cpu.system[ssCpuRawSystem.{#SNMPINDEX}]
        - sortorder: '1'
          color: F63100
          item:
            host: Vsat by SNMP
            key: system.cpu.user[ssCpuRawUser.{#SNMPINDEX}]
        - sortorder: '2'
          color: 00611C
          item:
            host: Vsat by SNMP
            key: system.cpu.nice[ssCpuRawNice.{#SNMPINDEX}]
        - sortorder: '3'
          color: F7941D
          item:
            host: Vsat by SNMP
            key: system.cpu.iowait[ssCpuRawWait.{#SNMPINDEX}]
        - sortorder: '4'
          color: FC6EA3
          item:
            host: Vsat by SNMP
            key: system.cpu.steal[ssCpuRawSteal.{#SNMPINDEX}]
        - sortorder: '5'
          color: 6C59DC
          item:
            host: Vsat by SNMP
            key: system.cpu.interrupt[ssCpuRawInterrupt.{#SNMPINDEX}]
        - sortorder: '6'
          color: C7A72D
          item:
            host: Vsat by SNMP
            key: system.cpu.softirq[ssCpuRawSoftIRQ.{#SNMPINDEX}]
        - sortorder: '7'
          color: BA2A5D
          item:
            host: Vsat by SNMP
            key: system.cpu.guest[ssCpuRawGuest.{#SNMPINDEX}]
        - sortorder: '8'
          color: F230E0
          item:
            host: Vsat by SNMP
            key: system.cpu.guest_nice[ssCpuRawGuestNice.{#SNMPINDEX}]
      - uuid: abe19885ec5f4466a0003a4d4a4676f6
        name: 'Linux: CPU utilization{#SINGLETON}'
        ymin_type_1: FIXED
        ymax_type_1: FIXED
        graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: Vsat by SNMP
            key: system.cpu.util[snmp,{#SNMPINDEX}]
      master_item:
        key: system.cpu.num[snmp]
      preprocessing:
      - type: JAVASCRIPT
        parameters:
        - 'return JSON.stringify([{"{#CPU.COUNT}": value, "{#SNMPINDEX}": 0, "{#SINGLETON}":""}])'
    - uuid: 900de51d6cc74ef98c275baacaa3b3b1
      name: Network interfaces discovery
      type: DEPENDENT
      key: net.if.discovery
      delay: '0'
      filter:
        evaltype: AND
        conditions:
        - macro: '{#IFADMINSTATUS}'
          value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          formulaid: A
        - macro: '{#IFADMINSTATUS}'
          value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: B
        - macro: '{#IFALIAS}'
          value: '{$NET.IF.IFALIAS.MATCHES}'
          formulaid: C
        - macro: '{#IFALIAS}'
          value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: D
        - macro: '{#IFDESCR}'
          value: '{$NET.IF.IFDESCR.MATCHES}'
          formulaid: E
        - macro: '{#IFDESCR}'
          value: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: F
        - macro: '{#IFNAME}'
          value: '{$NET.IF.IFNAME.MATCHES}'
          formulaid: G
        - macro: '{#IFNAME}'
          value: '{$NET.IF.IFNAME.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: H
        - macro: '{#IFOPERSTATUS}'
          value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          formulaid: I
        - macro: '{#IFOPERSTATUS}'
          value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: J
        - macro: '{#IFTYPE}'
          value: '{$NET.IF.IFTYPE.MATCHES}'
          formulaid: K
        - macro: '{#IFTYPE}'
          value: '{$NET.IF.IFTYPE.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: L
      description: Discovering interfaces from IF-MIB.
      item_prototypes:
      - uuid: f1ab3fa10f524a2eb2095d8d2a97c251
        name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
        type: DEPENDENT
        key: net.if.in.discards[ifInDiscards.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        description: |
          MIB: IF-MIB
          The number of inbound packets which were chosen to be discarded
          even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
          One possible reason for discarding such a packet could be to free up buffer space.
          Discontinuities in the value of this counter can occur at re-initialization of the management system,
          and at other times as indicated by the value of ifCounterDiscontinuityTime.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - 3m
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      - uuid: 6250ffc382cc4d179cdc93e1803a748b
        name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
        type: DEPENDENT
        key: net.if.in.errors[ifInErrors.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        description: |
          MIB: IF-MIB
          For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - 3m
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      - uuid: 92502a85c0714d4ab03550e1e92e15cf
        name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
        type: DEPENDENT
        key: net.if.in[ifHCInOctets.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        units: bps
        description: |
          MIB: IF-MIB
          The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      - uuid: 9084c590ef0a4caaae25b972faeea6e6
        name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
        type: DEPENDENT
        key: net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        description: |
          MIB: IF-MIB
          The number of outbound packets which were chosen to be discarded
          even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
          One possible reason for discarding such a packet could be to free up buffer space.
          Discontinuities in the value of this counter can occur at re-initialization of the management system,
          and at other times as indicated by the value of ifCounterDiscontinuityTime.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - 3m
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      - uuid: acea2f231b6d4ef08d0c71a832a669db
        name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
        type: DEPENDENT
        key: net.if.out.errors[ifOutErrors.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        description: |
          MIB: IF-MIB
          For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - 3m
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      - uuid: f6436480c1754b1581034cfd56bda017
        name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
        type: DEPENDENT
        key: net.if.out[ifHCOutOctets.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        units: bps
        description: |
          MIB: IF-MIB
          The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        - type: MULTIPLIER
          parameters:
          - '8'
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      - uuid: 210014d6a1444ab397421fadec2ab9c8
        name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
        type: DEPENDENT
        key: net.if.speed[ifHighSpeed.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        trends: '0'
        units: bps
        description: |
          MIB: IF-MIB
          An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n`, then the speed of the interface is somewhere in the range of `n-500,000` to `n+499,999`.
          For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth.
          For a sub-layer which has no concept of bandwidth, this object should be zero.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}
          - '0'
        - type: MULTIPLIER
          parameters:
          - '1000000'
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - 1h
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      - uuid: ba79b1f6d6d749eaa8ff46bc4385e941
        name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
        type: DEPENDENT
        key: net.if.status[ifOperStatus.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        trends: '0'
        description: |
          MIB: IF-MIB
          The current operational state of the interface.
          - The testing(3) state indicates that no operational packet scan be passed
          - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
          - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
          - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
          - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
          - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
        valuemap:
          name: IF-MIB::ifOperStatus
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}
          - '0'
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
        trigger_prototypes:
        - uuid: 07fb91891d2d41b7a3d44fffcbc3670f
          expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2
            and (last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Vsat
            by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
          recovery_mode: RECOVERY_EXPRESSION
          recovery_expression: last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2
            or {$IFCONTROL:"{#IFNAME}"}=0
          name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
          opdata: 'Current state: {ITEM.LASTVALUE1}'
          priority: AVERAGE
          description: |
            This trigger expression works as follows:
            1. It can be triggered if the operations status is down.
            2. `{$IFCONTROL:"{#IFNAME}"}=1` - a user can redefine the context macro to "0", marking this interface as not important. No new trigger will be fired if this interface is down.
            3. `last(/TEMPLATE_NAME/METRIC,#1)<>last(/TEMPLATE_NAME/METRIC,#2)` - the trigger fires only if the operational status was up to (1) sometime before (so, does not fire for "eternal off" interfaces.)

            WARNING: if closed manually - it will not fire again on the next poll, because of .diff.
          manual_close: YES
          tags:
          - tag: scope
            value: availability
      - uuid: 67a9c3fa1d0a49f5a11d34d0dea8ee15
        name: 'Interface {#IFNAME}({#IFALIAS}): Interface type'
        type: DEPENDENT
        key: net.if.type[ifType.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        trends: '0'
        description: |
          MIB: IF-MIB
          The type of interface.
          Additional values for ifType are assigned by the Internet Assigned Numbers Authority (IANA),
          through updating the syntax of the IANAifType textual convention.
        valuemap:
          name: IF-MIB::ifType
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.2.2.1.3.{#SNMPINDEX}
          - '0'
        - type: DISCARD_UNCHANGED_HEARTBEAT
          parameters:
          - 1d
        master_item:
          key: net.if.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
      trigger_prototypes:
      - uuid: 3489b19a1c174657a48fa29720551497
        expression: |
          change(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])<0 and last(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
          and (
          last(/Vsat by SNMP/net.if.type[ifType.{#SNMPINDEX}])=6 or
          last(/Vsat by SNMP/net.if.type[ifType.{#SNMPINDEX}])=7 or
          last(/Vsat by SNMP/net.if.type[ifType.{#SNMPINDEX}])=11 or
          last(/Vsat by SNMP/net.if.type[ifType.{#SNMPINDEX}])=62 or
          last(/Vsat by SNMP/net.if.type[ifType.{#SNMPINDEX}])=69 or
          last(/Vsat by SNMP/net.if.type[ifType.{#SNMPINDEX}])=117
          )
          and
          (last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2)
        recovery_mode: RECOVERY_EXPRESSION
        recovery_expression: |
          (change(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0 and last(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}],#2)>0) or
          (last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2)
        name: 'Interface {#IFNAME}({#IFALIAS}): Ethernet has changed to lower speed
          than it was before'
        opdata: 'Current reported speed: {ITEM.LASTVALUE1}'
        priority: INFO
        description: This Ethernet connection has transitioned down from its known
          maximum speed. This might be a sign of autonegotiation issues. Acknowledge
          to close the problem manually.
        manual_close: YES
        dependencies:
        - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
          expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2
            and (last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Vsat
            by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
          recovery_expression: last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2
            or {$IFCONTROL:"{#IFNAME}"}=0
        tags:
        - tag: scope
          value: performance
      - uuid: 41efebb48fed44a982df2aa40985c82a
        expression: |
          (avg(/Vsat by SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
          avg(/Vsat by SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
          last(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
        recovery_mode: RECOVERY_EXPRESSION
        recovery_expression: |
          avg(/Vsat by SNMP/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
          avg(/Vsat by SNMP/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Vsat by SNMP/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
        name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage'
        event_name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage (>{$IF.UTIL.MAX:"{#IFNAME}"}%)'
        opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
        priority: WARNING
        description: The utilization of the network interface is close to its estimated
          maximum bandwidth.
        manual_close: YES
        dependencies:
        - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
          expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2
            and (last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Vsat
            by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
          recovery_expression: last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2
            or {$IFCONTROL:"{#IFNAME}"}=0
        tags:
        - tag: scope
          value: performance
      - uuid: 8c0a719af35b4d4f80dbb3ec2c75b9ee
        expression: |
          min(/Vsat by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
          or min(/Vsat by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
        recovery_mode: RECOVERY_EXPRESSION
        recovery_expression: |
          max(/Vsat by SNMP/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
          and max(/Vsat by SNMP/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
        name: 'Interface {#IFNAME}({#IFALIAS}): High error rate'
        event_name: 'Interface {#IFNAME}({#IFALIAS}): High error rate (>{$IF.ERRORS.WARN:"{#IFNAME}"}
          for 5m)'
        opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
        priority: WARNING
        description: It recovers when it is below 80% of the `{$IF.ERRORS.WARN:"{#IFNAME}"}`
          threshold.
        manual_close: YES
        dependencies:
        - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
          expression: '{$IFCONTROL:"{#IFNAME}"}=1 and last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])=2
            and (last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Vsat
            by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))'
          recovery_expression: last(/Vsat by SNMP/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2
            or {$IFCONTROL:"{#IFNAME}"}=0
        tags:
        - tag: scope
          value: availability
        - tag: scope
          value: performance
      graph_prototypes:
      - uuid: 1a242c054aba4470a497962b6063ce0b
        name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
        graph_items:
        - drawtype: GRADIENT_LINE
          color: 199C0D
          item:
            host: Vsat by SNMP
            key: net.if.in[ifHCInOctets.{#SNMPINDEX}]
        - sortorder: '1'
          drawtype: BOLD_LINE
          color: F63100
          item:
            host: Vsat by SNMP
            key: net.if.out[ifHCOutOctets.{#SNMPINDEX}]
        - sortorder: '2'
          color: 00611C
          yaxisside: RIGHT
          item:
            host: Vsat by SNMP
            key: net.if.out.errors[ifOutErrors.{#SNMPINDEX}]
        - sortorder: '3'
          color: F7941D
          yaxisside: RIGHT
          item:
            host: Vsat by SNMP
            key: net.if.in.errors[ifInErrors.{#SNMPINDEX}]
        - sortorder: '4'
          color: FC6EA3
          yaxisside: RIGHT
          item:
            host: Vsat by SNMP
            key: net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]
        - sortorder: '5'
          color: 6C59DC
          yaxisside: RIGHT
          item:
            host: Vsat by SNMP
            key: net.if.in.discards[ifInDiscards.{#SNMPINDEX}]
      master_item:
        key: net.if.walk
      preprocessing:
      - type: SNMP_WALK_TO_JSON
        parameters:
        - '{#IFOPERSTATUS}'
        - 1.3.6.1.2.1.2.2.1.8
        - '0'
        - '{#IFADMINSTATUS}'
        - 1.3.6.1.2.1.2.2.1.7
        - '0'
        - '{#IFALIAS}'
        - 1.3.6.1.2.1.31.1.1.1.18
        - '0'
        - '{#IFNAME}'
        - 1.3.6.1.2.1.31.1.1.1.1
        - '0'
        - '{#IFDESCR}'
        - 1.3.6.1.2.1.2.2.1.2
        - '0'
        - '{#IFTYPE}'
        - 1.3.6.1.2.1.2.2.1.3
        - '0'
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 1h
    - uuid: 960d0cf6521248f18855bbf375ea1347
      name: EtherLike-MIB Discovery
      type: DEPENDENT
      key: net.if.duplex.discovery
      delay: '0'
      filter:
        evaltype: AND
        conditions:
        - macro: '{#IFOPERSTATUS}'
          value: '1'
          formulaid: A
        - macro: '{#SNMPVALUE}'
          value: (2|3)
          formulaid: B
        - macro: '{#SNMPVALUE}'
          operator: EXISTS
          formulaid: C
      description: Discovering interfaces from IF-MIB and EtherLike-MIB. Interfaces
        with `up(1)` Operational Status are discovered.
      item_prototypes:
      - uuid: 10cfa9d9c7514ac9965e2c4afde0d08e
        name: 'Interface {#IFNAME}({#IFALIAS}): Duplex status'
        type: DEPENDENT
        key: net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        description: |
          MIB: EtherLike-MIB
          The current mode of operation of the MAC entity. `unknown` indicates that the current duplex mode could not be determined.
          Management control of the duplex mode is accomplished through the MAU MIB. When an interface does not support autonegotiation or when autonegotiation is not enabled, the duplex mode is controlled using `ifMauDefaultType`. When autonegotiation is supported and enabled, duplex mode is controlled using `ifMauAutoNegAdvertisedBits`. In either case, the currently operating duplex mode in reflected both in this object and in `ifMauType`.
          Note that this object provides redundant information with `ifMauType`. Normally, redundant objects are discouraged. However, in this instance, it allows a management application to determine the duplex status of an interface without having to know every possible value of `ifMauType`. This was felt to be sufficiently valuable to justify the redundancy.
          Reference: [IEEE 802.3 Std.], 30.3.1.1.32,aDuplexStatus.
        valuemap:
          name: EtherLike-MIB::dot3StatsDuplexStatus
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.2.1.10.7.2.1.19.{#SNMPINDEX}
          - '0'
        master_item:
          key: net.if.duplex.walk
        tags:
        - tag: component
          value: network
        - tag: description
          value: '{#IFALIAS}'
        - tag: interface
          value: '{#IFNAME}'
        trigger_prototypes:
        - uuid: ebc21491154445c78cba520ff25e9ca9
          expression: last(/Vsat by SNMP/net.if.duplex[dot3StatsDuplexStatus.{#SNMPINDEX}])=2
          name: 'Interface {#IFNAME}({#IFALIAS}): In half-duplex mode'
          priority: WARNING
          description: Please check autonegotiation settings and cabling.
          manual_close: YES
          tags:
          - tag: scope
            value: performance
      master_item:
        key: net.if.duplex.walk
      preprocessing:
      - type: SNMP_WALK_TO_JSON
        parameters:
        - '{#SNMPVALUE}'
        - 1.3.6.1.2.1.10.7.2.1.19
        - '0'
        - '{#IFOPERSTATUS}'
        - 1.3.6.1.2.1.2.2.1.8
        - '0'
        - '{#IFALIAS}'
        - 1.3.6.1.2.1.31.1.1.1.18
        - '0'
        - '{#IFNAME}'
        - 1.3.6.1.2.1.31.1.1.1.1
        - '0'
        - '{#IFDESCR}'
        - 1.3.6.1.2.1.2.2.1.2
        - '0'
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 1h
    - uuid: d7570576589242d99c56ad06f4ff7e87
      name: Block devices discovery
      type: DEPENDENT
      key: vfs.dev.discovery[snmp]
      delay: '0'
      filter:
        evaltype: AND
        conditions:
        - macro: '{#DEVNAME}'
          value: '{$VFS.DEV.DEVNAME.MATCHES}'
          formulaid: A
        - macro: '{#DEVNAME}'
          value: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: B
      description: Block devices are discovered from UCD-DISKIO-MIB::diskIOTable (http://net-snmp.sourceforge.net/docs/mibs/ucdDiskIOMIB.html#diskIOTable)
      item_prototypes:
      - uuid: 5ac79179fce74149885e35b880078389
        name: '{#DEVNAME}: Disk read rate'
        type: DEPENDENT
        key: vfs.dev.read.rate[diskIOReads.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '!r/s'
        description: |
          MIB: UCD-DISKIO-MIB
          The number of read accesses from this device since boot.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.13.15.1.1.5.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        master_item:
          key: vfs.dev.walk
        tags:
        - tag: component
          value: storage
        - tag: disk
          value: '{#DEVNAME}'
      - uuid: 96a92abba4854f449da9eba2c2093c8e
        name: '{#DEVNAME}: Disk utilization'
        type: DEPENDENT
        key: vfs.dev.util[diskIOLA1.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-DISKIO-MIB
          The 1 minute average load of disk (%)
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.13.15.1.1.9.{#SNMPINDEX}
          - '0'
        master_item:
          key: vfs.dev.walk
        tags:
        - tag: component
          value: storage
        - tag: disk
          value: '{#DEVNAME}'
      - uuid: 2870aa49c99c49dea706700393cacd34
        name: '{#DEVNAME}: Disk write rate'
        type: DEPENDENT
        key: vfs.dev.write.rate[diskIOWrites.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '!w/s'
        description: |
          MIB: UCD-DISKIO-MIB
          The number of write accesses from this device since boot.
        preprocessing:
        - type: SNMP_WALK_VALUE
          parameters:
          - 1.3.6.1.4.1.2021.13.15.1.1.6.{#SNMPINDEX}
          - '0'
        - type: CHANGE_PER_SECOND
          parameters:
          - ''
        master_item:
          key: vfs.dev.walk
        tags:
        - tag: component
          value: storage
        - tag: disk
          value: '{#DEVNAME}'
      graph_prototypes:
      - uuid: c7c771b309844f669f005a7e39ca1658
        name: '{#DEVNAME}: Disk read/write rates'
        graph_items:
        - color: 199C0D
          item:
            host: Vsat by SNMP
            key: vfs.dev.read.rate[diskIOReads.{#SNMPINDEX}]
        - sortorder: '1'
          drawtype: GRADIENT_LINE
          color: F63100
          item:
            host: Vsat by SNMP
            key: vfs.dev.write.rate[diskIOWrites.{#SNMPINDEX}]
      master_item:
        key: vfs.dev.walk
      preprocessing:
      - type: SNMP_WALK_TO_JSON
        parameters:
        - '{#DEVNAME}'
        - 1.3.6.1.4.1.2021.13.15.1.1.2
        - '0'
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 1h
    - uuid: 0a85fb6e93064ce39c1134fcbf40bc4e
      name: Mounted filesystem discovery
      type: DEPENDENT
      key: vfs.fs.discovery[snmp]
      delay: '0'
      filter:
        evaltype: AND
        conditions:
        - macro: '{#FSDEVICE}'
          value: '{$VFS.FS.FSDEVICE.MATCHES}'
          formulaid: A
        - macro: '{#FSDEVICE}'
          value: '{$VFS.FS.FSDEVICE.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: B
        - macro: '{#FSNAME}'
          value: '{$VFS.FS.FSNAME.MATCHES}'
          formulaid: C
        - macro: '{#FSNAME}'
          value: '{$VFS.FS.FSNAME.NOT_MATCHES}'
          operator: NOT_MATCHES_REGEX
          formulaid: D
      description: UCD-SNMP-MIB::dskEntry table discovery with storage filter
      item_prototypes:
      - uuid: 65a4767700544cba9b15c2ca67249f2b
        name: 'FS [{#FSNAME}]: Space: Available'
        type: DEPENDENT
        key: vfs.fs.free[dskAvail.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: B
        description: |
          UCD-SNMP-MIB::dskEntry
          Available storage space is calculated from two portions:
            dskAvailHigh
            dskAvailLow
          Together they compose 64-bit number.
        preprocessing:
        - type: JAVASCRIPT
          parameters:
          - |
            var portionHigh = 4294967296;
            var obj = JSON.parse(value);
            var dskAvailHigh = obj['dskAvailHigh'],
            	dskAvailLow = obj['dskAvailLow'];

            return (dskAvailHigh * portionHigh + dskAvailLow) * 1024;
        master_item:
          key: vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]
        tags:
        - tag: component
          value: storage
        - tag: filesystem
          value: '{#FSNAME}'
      - uuid: cd1f0e1ec6b4492188726c85990c8382
        name: 'FS [{#FSNAME}]: Inodes: Free, in %'
        type: DEPENDENT
        key: vfs.fs.inode.pfree[{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          MIB: UCD-SNMP-MIB
          Free metadata space expressed as percentage.
        preprocessing:
        - type: JAVASCRIPT
          parameters:
          - |
            var obj = JSON.parse(value);
            var dskPercentNode = obj['dskPercentNode'];

            return (100 - dskPercentNode);
        master_item:
          key: vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]
        tags:
        - tag: component
          value: storage
        - tag: filesystem
          value: '{#FSNAME}'
        trigger_prototypes:
        - uuid: e9e54a35cd61401b8f1b86a334044582
          expression: min(/Vsat by 
            SNMP/vfs.fs.inode.pfree[{#SNMPINDEX}],5m)<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}
          name: 'FS [{#FSNAME}]: Running out of free inodes'
          event_name: 'FS [{#FSNAME}]: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}%)'
          opdata: 'Free inodes: {ITEM.LASTVALUE1}'
          priority: AVERAGE
          description: Disk writing may fail if index nodes are exhausted, leading
            to error messages like "No space left on device" or "Disk is full", despite
            available free space.
          tags:
          - tag: scope
            value: capacity
          - tag: scope
            value: performance
        - uuid: 087b5a3db63a4d29a8a4b93bb3e49a12
          expression: min(/Vsat by 
            SNMP/vfs.fs.inode.pfree[{#SNMPINDEX}],5m)<{$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}
          name: 'FS [{#FSNAME}]: Running out of free inodes'
          event_name: 'FS [{#FSNAME}]: Running out of free inodes (free < {$VFS.FS.INODE.PFREE.MIN.WARN:"{#FSNAME}"}%)'
          opdata: 'Free inodes: {ITEM.LASTVALUE1}'
          priority: WARNING
          description: Disk writing may fail if index nodes are exhausted, leading
            to error messages like "No space left on device" or "Disk is full", despite
            available free space.
          dependencies:
          - name: 'FS [{#FSNAME}]: Running out of free inodes'
            expression: min(/Vsat by 
              SNMP/vfs.fs.inode.pfree[{#SNMPINDEX}],5m)<{$VFS.FS.INODE.PFREE.MIN.CRIT:"{#FSNAME}"}
          tags:
          - tag: scope
            value: capacity
          - tag: scope
            value: performance
      - uuid: a53276dbadc04944b755250a6c5d3c0b
        name: 'FS [{#FSNAME}]: Space: Used, in %'
        type: DEPENDENT
        key: vfs.fs.pused[{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: '%'
        description: |
          UCD-SNMP-MIB::dskEntry
          Space utilization is calculated as the percentage of currently used space compared to the maximum available space.
        preprocessing:
        - type: JAVASCRIPT
          parameters:
          - |
            var portionHigh = 4294967296;
            var obj = JSON.parse(value);
            var dskAvailHigh = obj['dskAvailHigh'],
            	dskAvailLow = obj['dskAvailLow'];
            var dskUsedHigh = obj['dskUsedHigh'],
            	dskUsedLow = obj['dskUsedLow'];

            var available = (dskAvailHigh * portionHigh + dskAvailLow) * 1024;
            var used = (dskUsedHigh * portionHigh + dskUsedLow) * 1024;

            if ((available + used) <= 0) {
            	return 0;
            } else {
            	return (100 * used / (used + available));
            }
        master_item:
          key: vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]
        tags:
        - tag: component
          value: storage
        - tag: filesystem
          value: '{#FSNAME}'
        trigger_prototypes:
        - uuid: 6b739928472f42b5a68eee2e35714872
          expression: min(/Vsat by SNMP/vfs.fs.pused[{#SNMPINDEX}],5m)>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}
          name: 'FS [{#FSNAME}]: Space is critically low'
          event_name: 'FS [{#FSNAME}]: Space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%,
            total {{?last(//vfs.fs.total[dskTotal.{#SNMPINDEX}])/1024/1024/1024}.fmtnum(1)}GB)'
          opdata: 'Space used: {{ITEM.LASTVALUE1}.fmtnum(1)}%'
          priority: AVERAGE
          description: |
            The volume's space usage exceeds the '{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}%' limit;
            The trigger expression is based on the current used and maximum available spaces.
            Event name represents the total volume space, which can differ from the maximum available space, depending on the filesystem type.
          manual_close: YES
          tags:
          - tag: scope
            value: availability
          - tag: scope
            value: capacity
        - uuid: dafbd0048ec44f5aa7b14111c3734bcc
          expression: min(/Vsat by SNMP/vfs.fs.pused[{#SNMPINDEX}],5m)>{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}
          name: 'FS [{#FSNAME}]: Space is low'
          event_name: 'FS [{#FSNAME}]: Space is low (used > {$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%,
            total {{?last(//vfs.fs.total[dskTotal.{#SNMPINDEX}])/1024/1024/1024}.fmtnum(1)}GB)'
          opdata: 'Space used: {{ITEM.LASTVALUE1}.fmtnum(1)}%'
          priority: WARNING
          description: |
            The volume's space usage exceeds the '{$VFS.FS.PUSED.MAX.WARN:"{#FSNAME}"}%' limit;
            The trigger expression is based on the current used and maximum available spaces.
            Event name represents the total volume space, which can differ from the maximum available space, depending on the filesystem type.
          manual_close: YES
          dependencies:
          - name: 'FS [{#FSNAME}]: Space is critically low'
            expression: min(/Vsat by SNMP/vfs.fs.pused[{#SNMPINDEX}],5m)>{$VFS.FS.PUSED.MAX.CRIT:"{#FSNAME}"}
          tags:
          - tag: scope
            value: availability
          - tag: scope
            value: capacity
      - uuid: d20878c7ccb04ee7a6eb757abdad7256
        name: 'FS [{#FSNAME}]: Space: Total'
        type: DEPENDENT
        key: vfs.fs.total[dskTotal.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: B
        description: |
          MIB: UCD-SNMP-MIB
          Total storage is calculated from two portions:
            dskTotalHigh
            dskTotalLow
          Together they compose 64-bit number.
        preprocessing:
        - type: JAVASCRIPT
          parameters:
          - |
            var portionHigh = 4294967296;
            var obj = JSON.parse(value);
            var dskTotalHigh = obj['dskTotalHigh'],
            	dskTotalLow = obj['dskTotalLow'];

            return (dskTotalHigh * portionHigh + dskTotalLow) * 1024;
        master_item:
          key: vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]
        tags:
        - tag: component
          value: storage
        - tag: filesystem
          value: '{#FSNAME}'
      - uuid: 0d019ad409274c8b86fa3dbde931255d
        name: 'FS [{#FSNAME}]: Space: Used'
        type: DEPENDENT
        key: vfs.fs.used[dskUsed.{#SNMPINDEX}]
        delay: '0'
        history: 7d
        value_type: FLOAT
        units: B
        description: |
          MIB: UCD-SNMP-MIB
          Used storage is calculated from two portions:
            dskUsedHigh
            dskUsedLow
          Together they compose 64-bit number.
          Reserverd space is not counted in.
        preprocessing:
        - type: JAVASCRIPT
          parameters:
          - |
            var portionHigh = 4294967296;
            var obj = JSON.parse(value);
            var dskUsedHigh = obj['dskUsedHigh'],
            	dskUsedLow = obj['dskUsedLow'];

            return (dskUsedHigh * portionHigh + dskUsedLow) * 1024;
        master_item:
          key: vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]
        tags:
        - tag: component
          value: storage
        - tag: filesystem
          value: '{#FSNAME}'
      - uuid: 876ec4c1c63e470bb987e5660928a8ea
        name: 'FS [{#FSNAME}]: Get data'
        type: DEPENDENT
        key: vfs.fs.walk.data[dskEntry.{#SNMPINDEX}]
        delay: '0'
        history: 1h
        value_type: TEXT
        trends: '0'
        description: |
          MIB: UCD-SNMP-MIB
          Intermediate data for subsequent processing.
        preprocessing:
        - type: JAVASCRIPT
          parameters:
          - |
            var data = JSON.parse(value);

            result = data.filter(function(obj) {
            	return obj["{\#SNMPINDEX}"] === "{#SNMPINDEX}";
            })[0];

            return JSON.stringify(result);
        master_item:
          key: vfs.fs.walk
        tags:
        - tag: component
          value: raw
        - tag: component
          value: storage
        - tag: filesystem
          value: '{#FSNAME}'
      graph_prototypes:
      - uuid: 2ac0aaeb04094acb8341c36b63da2999
        name: 'FS [{#FSNAME}]: Space usage graph, in % (relative to max available)'
        width: '600'
        height: '340'
        ymin_type_1: FIXED
        ymax_type_1: FIXED
        graph_items:
        - drawtype: FILLED_REGION
          color: F63100
          calc_fnc: LAST
          item:
            host: Vsat by SNMP
            key: vfs.fs.pused[{#SNMPINDEX}]
      - uuid: 4f41e475462744459b70d62cb45b3946
        name: 'FS [{#FSNAME}]: Space utilization chart (relative to total)'
        width: '600'
        height: '340'
        type: PIE
        show_3d: YES
        graph_items:
        - color: '787878'
          calc_fnc: LAST
          type: GRAPH_SUM
          item:
            host: Vsat by SNMP
            key: vfs.fs.total[dskTotal.{#SNMPINDEX}]
        - sortorder: '1'
          color: F63100
          calc_fnc: LAST
          item:
            host: Vsat by SNMP
            key: vfs.fs.used[dskUsed.{#SNMPINDEX}]
        - sortorder: '2'
          color: 199C09
          calc_fnc: LAST
          item:
            host: Vsat by SNMP
            key: vfs.fs.free[dskAvail.{#SNMPINDEX}]
      master_item:
        key: vfs.fs.walk
      lld_macro_paths:
      - lld_macro: '{#FSDEVICE}'
        path: $.dskDevice
      - lld_macro: '{#FSNAME}'
        path: $.dskPath
      - lld_macro: '{#SNMPINDEX}'
        path: $.index
      preprocessing:
      - type: JAVASCRIPT
        parameters:
        - |
          var filesystems = JSON.parse(value);

          result = filesystems.map(function (filesystem) {
          	return {
          		'dskPath': filesystem.dskPath,
          		'dskDevice': filesystem.dskDevice,
          		'index': filesystem['{#SNMPINDEX}']
          	};
          });

          return JSON.stringify(result);
      - type: DISCARD_UNCHANGED_HEARTBEAT
        parameters:
        - 1h
    tags:
    - tag: class
      value: os
    - tag: target
      value: linux
    macros:
    - macro: '{$CPU.UTIL.CRIT}'
      value: '90'
      description: Critical threshold of CPU utilization expressed in %.
    - macro: '{$ICMP_LOSS_WARN}'
      value: '20'
      description: Warning threshold of ICMP packet loss in %.
    - macro: '{$ICMP_RESPONSE_TIME_WARN}'
      value: '1.2'
      description: Warning threshold of the average ICMP response time in seconds.
    - macro: '{$IF.ERRORS.WARN}'
      value: '2'
      description: Warning threshold of error packet rate. Can be used with interface
        name as context.
    - macro: '{$IF.UTIL.MAX}'
      value: '90'
      description: Used as a threshold in the interface utilization trigger.
    - macro: '{$IFCONTROL}'
      value: '1'
      description: Link status trigger will be fired only for interfaces where the
        context macro equals "1".
    - macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
      value: '1.5'
      description: Load per CPU considered sustainable. Tune if needed.
    - macro: '{$MEMORY.AVAILABLE.MIN}'
      value: 20M
      description: Used as a threshold in the available memory trigger.
    - macro: '{$MEMORY.UTIL.MAX}'
      value: '90'
      description: Used as a threshold in the memory utilization trigger.
    - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
      value: ^.*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
      value: ^2$
      description: Ignore `down(2)` administrative status
    - macro: '{$NET.IF.IFALIAS.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFDESCR.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFNAME.MATCHES}'
      value: ^.*$
      description: Used for network interface discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
      value: (^Software Loopback 
        Interface|^NULL[0-9.]*$|^[Ll]o[0-9.]*$|^[Ss]ystem$|^Nu[0-9.]*$|^veth[0-9a-z]+$|docker[0-9]+|br-[a-z0-9]{12})
      description: Filters out `loopbacks`, `nulls`, docker `veth` links and `docker0
        bridge` by default.
    - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
      value: ^.*$
      description: Used for network interface discovery. Can be overridden on the
        host or linked template level.
    - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
      value: ^6$
      description: Ignore `notPresent(6)`
    - macro: '{$NET.IF.IFTYPE.MATCHES}'
      value: .*
      description: Used in network interface discovery rule filters.
    - macro: '{$NET.IF.IFTYPE.NOT_MATCHES}'
      value: CHANGE_IF_NEEDED
      description: Used in network interface discovery rule filters.
    - macro: '{$SNMP.TIMEOUT}'
      value: 5m
      description: Time interval for the SNMP availability trigger.
    - macro: '{$SWAP.PFREE.MIN.WARN}'
      value: '50'
      description: The warning threshold of the minimum free swap.
    - macro: '{$VFS.DEV.DEVNAME.MATCHES}'
      value: .+
      description: Used in block device discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.DEV.DEVNAME.NOT_MATCHES}'
      value: 
        ^(loop[0-9]*|sd[a-z][0-9]+|nbd[0-9]+|sr[0-9]+|fd[0-9]+|dm-[0-9]+|ram[0-9]+|ploop[a-z0-9]+|md[0-9]*|hcp[0-9]*|zram[0-9]*)
      description: Used in block device discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSDEVICE.MATCHES}'
      value: .+
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSDEVICE.NOT_MATCHES}'
      value: .*(tmpfs|shm)$
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSNAME.MATCHES}'
      value: .+
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.FSNAME.NOT_MATCHES}'
      value: ^(/dev|/sys|/run|/proc|.+/shm$)
      description: Used in filesystem discovery. Can be overridden on the host or
        linked template level.
    - macro: '{$VFS.FS.INODE.PFREE.MIN.CRIT}'
      value: '10'
      description: The critical threshold of the filesystem metadata utilization.
    - macro: '{$VFS.FS.INODE.PFREE.MIN.WARN}'
      value: '20'
      description: The warning threshold of the filesystem metadata utilization.
    - macro: '{$VFS.FS.PUSED.MAX.CRIT}'
      value: '90'
      description: The critical threshold of the filesystem utilization.
    - macro: '{$VFS.FS.PUSED.MAX.WARN}'
      value: '80'
      description: The warning threshold of the filesystem utilization.
    dashboards:
    - uuid: fff107d8a0cf4b20b4959143a4ae056e
      name: Network interfaces
      pages:
      - widgets:
        - type: graphprototype
          width: '72'
          height: '11'
          fields:
          - type: INTEGER
            name: columns
            value: '1'
          - type: GRAPH_PROTOTYPE
            name: graphid.0
            value:
              host: Vsat by SNMP
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
          - type: STRING
            name: reference
            value: AAAAI
          - type: INTEGER
            name: rows
            value: '2'
    - uuid: b914f86116eb4770a59ed7b73932c346
      name: System performance
      pages:
      - widgets:
        - type: graph
          width: '36'
          height: '5'
          fields:
          - type: GRAPH
            name: graphid.0
            value:
              host: Vsat by SNMP
              name: 'Linux: System load'
          - type: STRING
            name: reference
            value: AAAAA
        - type: graph
          y: '5'
          width: '36'
          height: '5'
          fields:
          - type: GRAPH
            name: graphid.0
            value:
              host: Vsat by SNMP
              name: 'Linux: Memory usage'
          - type: STRING
            name: reference
            value: AAAAC
        - type: graphprototype
          y: '10'
          width: '72'
          height: '5'
          fields:
          - type: INTEGER
            name: columns
            value: '1'
          - type: GRAPH_PROTOTYPE
            name: graphid.0
            value:
              host: Vsat by SNMP
              name: 'Interface {#IFNAME}({#IFALIAS}): Network traffic'
          - type: STRING
            name: reference
            value: AAAAH
        - type: graphprototype
          x: '36'
          width: '36'
          height: '5'
          fields:
          - type: INTEGER
            name: columns
            value: '1'
          - type: GRAPH_PROTOTYPE
            name: graphid.0
            value:
              host: Vsat by SNMP
              name: 'Linux: CPU usage{#SINGLETON}'
          - type: STRING
            name: reference
            value: AAAAB
        - type: graph
          x: '36'
          y: '5'
          width: '36'
          height: '5'
          fields:
          - type: GRAPH
            name: graphid.0
            value:
              host: Vsat by SNMP
              name: 'Linux: Swap usage'
          - type: STRING
            name: reference
            value: AAAAD
    valuemaps:
    - uuid: b733b3f5bb65479fab8e52ada43b15b9
      name: EtherLike-MIB::dot3StatsDuplexStatus
      mappings:
      - value: '1'
        newvalue: unknown
      - value: '2'
        newvalue: halfDuplex
      - value: '3'
        newvalue: fullDuplex
    - uuid: bc048f222ffe4c6a9c9565027c69e4e4
      name: IF-MIB::ifOperStatus
      mappings:
      - value: '1'
        newvalue: up
      - value: '2'
        newvalue: down
      - value: '4'
        newvalue: unknown
      - value: '5'
        newvalue: dormant
      - value: '6'
        newvalue: notPresent
      - value: '7'
        newvalue: lowerLayerDown
    - uuid: 3da91a4912d048a989c7acedcb33bc84
      name: IF-MIB::ifType
      mappings:
      - value: '1'
        newvalue: other
      - value: '2'
        newvalue: regular1822
      - value: '3'
        newvalue: hdh1822
      - value: '4'
        newvalue: ddnX25
      - value: '5'
        newvalue: rfc877x25
      - value: '6'
        newvalue: ethernetCsmacd
      - value: '7'
        newvalue: iso88023Csmacd
      - value: '8'
        newvalue: iso88024TokenBus
      - value: '9'
        newvalue: iso88025TokenRing
      - value: '10'
        newvalue: iso88026Man
      - value: '11'
        newvalue: starLan
      - value: '12'
        newvalue: proteon10Mbit
      - value: '13'
        newvalue: proteon80Mbit
      - value: '14'
        newvalue: hyperchannel
      - value: '15'
        newvalue: fddi
      - value: '16'
        newvalue: lapb
      - value: '17'
        newvalue: sdlc
      - value: '18'
        newvalue: ds1
      - value: '19'
        newvalue: e1
      - value: '20'
        newvalue: basicISDN
      - value: '21'
        newvalue: primaryISDN
      - value: '22'
        newvalue: propPointToPointSerial
      - value: '23'
        newvalue: ppp
      - value: '24'
        newvalue: softwareLoopback
      - value: '25'
        newvalue: eon
      - value: '26'
        newvalue: ethernet3Mbit
      - value: '27'
        newvalue: nsip
      - value: '28'
        newvalue: slip
      - value: '29'
        newvalue: ultra
      - value: '30'
        newvalue: ds3
      - value: '31'
        newvalue: sip
      - value: '32'
        newvalue: frameRelay
      - value: '33'
        newvalue: rs232
      - value: '34'
        newvalue: para
      - value: '35'
        newvalue: arcnet
      - value: '36'
        newvalue: arcnetPlus
      - value: '37'
        newvalue: atm
      - value: '38'
        newvalue: miox25
      - value: '39'
        newvalue: sonet
      - value: '40'
        newvalue: x25ple
      - value: '41'
        newvalue: iso88022llc
      - value: '42'
        newvalue: localTalk
      - value: '43'
        newvalue: smdsDxi
      - value: '44'
        newvalue: frameRelayService
      - value: '45'
        newvalue: v35
      - value: '46'
        newvalue: hssi
      - value: '47'
        newvalue: hippi
      - value: '48'
        newvalue: modem
      - value: '49'
        newvalue: aal5
      - value: '50'
        newvalue: sonetPath
      - value: '51'
        newvalue: sonetVT
      - value: '52'
        newvalue: smdsIcip
      - value: '53'
        newvalue: propVirtual
      - value: '54'
        newvalue: propMultiplexor
      - value: '55'
        newvalue: ieee80212
      - value: '56'
        newvalue: fibreChannel
      - value: '57'
        newvalue: hippiInterface
      - value: '58'
        newvalue: frameRelayInterconnect
      - value: '59'
        newvalue: aflane8023
      - value: '60'
        newvalue: aflane8025
      - value: '61'
        newvalue: cctEmul
      - value: '62'
        newvalue: fastEther
      - value: '63'
        newvalue: isdn
      - value: '64'
        newvalue: v11
      - value: '65'
        newvalue: v36
      - value: '66'
        newvalue: g703at64k
      - value: '67'
        newvalue: g703at2mb
      - value: '68'
        newvalue: qllc
      - value: '69'
        newvalue: fastEtherFX
      - value: '70'
        newvalue: channel
      - value: '71'
        newvalue: ieee80211
      - value: '72'
        newvalue: ibm370parChan
      - value: '73'
        newvalue: escon
      - value: '74'
        newvalue: dlsw
      - value: '75'
        newvalue: isdns
      - value: '76'
        newvalue: isdnu
      - value: '77'
        newvalue: lapd
      - value: '78'
        newvalue: ipSwitch
      - value: '79'
        newvalue: rsrb
      - value: '80'
        newvalue: atmLogical
      - value: '81'
        newvalue: ds0
      - value: '82'
        newvalue: ds0Bundle
      - value: '83'
        newvalue: bsc
      - value: '84'
        newvalue: async
      - value: '85'
        newvalue: cnr
      - value: '86'
        newvalue: iso88025Dtr
      - value: '87'
        newvalue: eplrs
      - value: '88'
        newvalue: arap
      - value: '89'
        newvalue: propCnls
      - value: '90'
        newvalue: hostPad
      - value: '91'
        newvalue: termPad
      - value: '92'
        newvalue: frameRelayMPI
      - value: '93'
        newvalue: x213
      - value: '94'
        newvalue: adsl
      - value: '95'
        newvalue: radsl
      - value: '96'
        newvalue: sdsl
      - value: '97'
        newvalue: vdsl
      - value: '98'
        newvalue: iso88025CRFPInt
      - value: '99'
        newvalue: myrinet
      - value: '100'
        newvalue: voiceEM
      - value: '101'
        newvalue: voiceFXO
      - value: '102'
        newvalue: voiceFXS
      - value: '103'
        newvalue: voiceEncap
      - value: '104'
        newvalue: voiceOverIp
      - value: '105'
        newvalue: atmDxi
      - value: '106'
        newvalue: atmFuni
      - value: '107'
        newvalue: atmIma
      - value: '108'
        newvalue: pppMultilinkBundle
      - value: '109'
        newvalue: ipOverCdlc
      - value: '110'
        newvalue: ipOverClaw
      - value: '111'
        newvalue: stackToStack
      - value: '112'
        newvalue: virtualIpAddress
      - value: '113'
        newvalue: mpc
      - value: '114'
        newvalue: ipOverAtm
      - value: '115'
        newvalue: iso88025Fiber
      - value: '116'
        newvalue: tdlc
      - value: '117'
        newvalue: gigabitEthernet
      - value: '118'
        newvalue: hdlc
      - value: '119'
        newvalue: lapf
      - value: '120'
        newvalue: v37
      - value: '121'
        newvalue: x25mlp
      - value: '122'
        newvalue: x25huntGroup
      - value: '123'
        newvalue: trasnpHdlc
      - value: '124'
        newvalue: interleave
      - value: '125'
        newvalue: fast
      - value: '126'
        newvalue: ip
      - value: '127'
        newvalue: docsCableMaclayer
      - value: '128'
        newvalue: docsCableDownstream
      - value: '129'
        newvalue: docsCableUpstream
      - value: '130'
        newvalue: a12MppSwitch
      - value: '131'
        newvalue: tunnel
      - value: '132'
        newvalue: coffee
      - value: '133'
        newvalue: ces
      - value: '134'
        newvalue: atmSubInterface
      - value: '135'
        newvalue: l2vlan
      - value: '136'
        newvalue: l3ipvlan
      - value: '137'
        newvalue: l3ipxvlan
      - value: '138'
        newvalue: digitalPowerline
      - value: '139'
        newvalue: mediaMailOverIp
      - value: '140'
        newvalue: dtm
      - value: '141'
        newvalue: dcn
      - value: '142'
        newvalue: ipForward
      - value: '143'
        newvalue: msdsl
      - value: '144'
        newvalue: ieee1394
      - value: '145'
        newvalue: if-gsn
      - value: '146'
        newvalue: dvbRccMacLayer
      - value: '147'
        newvalue: dvbRccDownstream
      - value: '148'
        newvalue: dvbRccUpstream
      - value: '149'
        newvalue: atmVirtual
      - value: '150'
        newvalue: mplsTunnel
      - value: '151'
        newvalue: srp
      - value: '152'
        newvalue: voiceOverAtm
      - value: '153'
        newvalue: voiceOverFrameRelay
      - value: '154'
        newvalue: idsl
      - value: '155'
        newvalue: compositeLink
      - value: '156'
        newvalue: ss7SigLink
      - value: '157'
        newvalue: propWirelessP2P
      - value: '158'
        newvalue: frForward
      - value: '159'
        newvalue: rfc1483
      - value: '160'
        newvalue: usb
      - value: '161'
        newvalue: ieee8023adLag
      - value: '162'
        newvalue: bgppolicyaccounting
      - value: '163'
        newvalue: frf16MfrBundle
      - value: '164'
        newvalue: h323Gatekeeper
      - value: '165'
        newvalue: h323Proxy
      - value: '166'
        newvalue: mpls
      - value: '167'
        newvalue: mfSigLink
      - value: '168'
        newvalue: hdsl2
      - value: '169'
        newvalue: shdsl
      - value: '170'
        newvalue: ds1FDL
      - value: '171'
        newvalue: pos
      - value: '172'
        newvalue: dvbAsiIn
      - value: '173'
        newvalue: dvbAsiOut
      - value: '174'
        newvalue: plc
      - value: '175'
        newvalue: nfas
      - value: '176'
        newvalue: tr008
      - value: '177'
        newvalue: gr303RDT
      - value: '178'
        newvalue: gr303IDT
      - value: '179'
        newvalue: isup
      - value: '180'
        newvalue: propDocsWirelessMaclayer
      - value: '181'
        newvalue: propDocsWirelessDownstream
      - value: '182'
        newvalue: propDocsWirelessUpstream
      - value: '183'
        newvalue: hiperlan2
      - value: '184'
        newvalue: propBWAp2Mp
      - value: '185'
        newvalue: sonetOverheadChannel
      - value: '186'
        newvalue: digitalWrapperOverheadChannel
      - value: '187'
        newvalue: aal2
      - value: '188'
        newvalue: radioMAC
      - value: '189'
        newvalue: atmRadio
      - value: '190'
        newvalue: imt
      - value: '191'
        newvalue: mvl
      - value: '192'
        newvalue: reachDSL
      - value: '193'
        newvalue: frDlciEndPt
      - value: '194'
        newvalue: atmVciEndPt
      - value: '195'
        newvalue: opticalChannel
      - value: '196'
        newvalue: opticalTransport
      - value: '197'
        newvalue: propAtm
      - value: '198'
        newvalue: voiceOverCable
      - value: '199'
        newvalue: infiniband
      - value: '200'
        newvalue: teLink
      - value: '201'
        newvalue: q2931
      - value: '202'
        newvalue: virtualTg
      - value: '203'
        newvalue: sipTg
      - value: '204'
        newvalue: sipSig
      - value: '205'
        newvalue: docsCableUpstreamChannel
      - value: '206'
        newvalue: econet
      - value: '207'
        newvalue: pon155
      - value: '208'
        newvalue: pon622
      - value: '209'
        newvalue: bridge
      - value: '210'
        newvalue: linegroup
      - value: '211'
        newvalue: voiceEMFGD
      - value: '212'
        newvalue: voiceFGDEANA
      - value: '213'
        newvalue: voiceDID
      - value: '214'
        newvalue: mpegTransport
      - value: '215'
        newvalue: sixToFour
      - value: '216'
        newvalue: gtp
      - value: '217'
        newvalue: pdnEtherLoop1
      - value: '218'
        newvalue: pdnEtherLoop2
      - value: '219'
        newvalue: opticalChannelGroup
      - value: '220'
        newvalue: homepna
      - value: '221'
        newvalue: gfp
      - value: '222'
        newvalue: ciscoISLvlan
      - value: '223'
        newvalue: actelisMetaLOOP
      - value: '224'
        newvalue: fcipLink
      - value: '225'
        newvalue: rpr
      - value: '226'
        newvalue: qam
      - value: '227'
        newvalue: lmp
      - value: '228'
        newvalue: cblVectaStar
      - value: '229'
        newvalue: docsCableMCmtsDownstream
      - value: '230'
        newvalue: adsl2
      - value: '231'
        newvalue: macSecControlledIF
      - value: '232'
        newvalue: macSecUncontrolledIF
      - value: '233'
        newvalue: aviciOpticalEther
      - value: '234'
        newvalue: atmbond
      - value: '235'
        newvalue: voiceFGDOS
      - value: '236'
        newvalue: mocaVersion1
      - value: '237'
        newvalue: ieee80216WMAN
      - value: '238'
        newvalue: adsl2plus
      - value: '239'
        newvalue: dvbRcsMacLayer
      - value: '240'
        newvalue: dvbTdm
      - value: '241'
        newvalue: dvbRcsTdma
      - value: '242'
        newvalue: x86Laps
      - value: '243'
        newvalue: wwanPP
      - value: '244'
        newvalue: wwanPP2
      - value: '245'
        newvalue: voiceEBS
      - value: '246'
        newvalue: ifPwType
      - value: '247'
        newvalue: ilan
      - value: '248'
        newvalue: pip
      - value: '249'
        newvalue: aluELP
      - value: '250'
        newvalue: gpon
      - value: '251'
        newvalue: vdsl2
      - value: '252'
        newvalue: capwapDot11Profile
      - value: '253'
        newvalue: capwapDot11Bss
      - value: '254'
        newvalue: capwapWtpVirtualRadio
      - value: '255'
        newvalue: bits
      - value: '256'
        newvalue: docsCableUpstreamRfPort
      - value: '257'
        newvalue: cableDownstreamRfPort
      - value: '258'
        newvalue: vmwareVirtualNic
      - value: '259'
        newvalue: ieee802154
      - value: '260'
        newvalue: otnOdu
      - value: '261'
        newvalue: otnOtu
      - value: '262'
        newvalue: ifVfiType
      - value: '263'
        newvalue: g9981
      - value: '264'
        newvalue: g9982
      - value: '265'
        newvalue: g9983
      - value: '266'
        newvalue: aluEpon
      - value: '267'
        newvalue: aluEponOnu
      - value: '268'
        newvalue: aluEponPhysicalUni
      - value: '269'
        newvalue: aluEponLogicalLink
      - value: '270'
        newvalue: aluGponOnu
      - value: '271'
        newvalue: aluGponPhysicalUni
      - value: '272'
        newvalue: vmwareNicTeam
      - value: '277'
        newvalue: docsOfdmDownstream
      - value: '278'
        newvalue: docsOfdmaUpstream
      - value: '279'
        newvalue: gfast
      - value: '280'
        newvalue: sdci
      - value: '281'
        newvalue: xboxWireless
      - value: '282'
        newvalue: fastdsl
      - value: '283'
        newvalue: docsCableScte55d1FwdOob
      - value: '284'
        newvalue: docsCableScte55d1RetOob
      - value: '285'
        newvalue: docsCableScte55d2DsOob
      - value: '286'
        newvalue: docsCableScte55d2UsOob
      - value: '287'
        newvalue: docsCableNdf
      - value: '288'
        newvalue: docsCableNdr
      - value: '289'
        newvalue: ptm
      - value: '290'
        newvalue: ghn
    - uuid: ec05605715d84bd18732edffedb302b0
      name: Service state
      mappings:
      - value: '0'
        newvalue: Down
      - value: '1'
        newvalue: Up
    - uuid: f0204f07ff6c4637aedfd00b120610bd
      name: zabbix.host.available
      mappings:
      - value: '0'
        newvalue: not available
      - value: '1'
        newvalue: available
      - value: '2'
        newvalue: unknown
  triggers:
  - uuid: 74c916d7b0834e6c8f4b67e482759fd9
    expression: max(/Vsat by SNMP/vm.memory.available[snmp],5m)<{$MEMORY.AVAILABLE.MIN}
      and last(/Vsat by SNMP/vm.memory.total[memTotalReal.0])>0
    name: Lack of available memory
    event_name: Lack of available memory (<{$MEMORY.AVAILABLE.MIN} of {ITEM.VALUE2})
    opdata: 'Available: {ITEM.LASTVALUE1}, total: {ITEM.LASTVALUE2}'
    priority: AVERAGE
    description: The system is running out of memory.
    tags:
    - tag: scope
      value: capacity
    - tag: scope
      value: performance
  - uuid: a737ad2730d64ef8989650b5f1050a14
    expression: |
      min(/Vsat by SNMP/system.cpu.load.avg1[laLoad.1],5m)/last(/Vsat by SNMP/system.cpu.num[snmp])>{$LOAD_AVG_PER_CPU.MAX.WARN}
      and last(/Vsat by SNMP/system.cpu.load.avg5[laLoad.2])>0
      and last(/Vsat by SNMP/system.cpu.load.avg15[laLoad.3])>0
    name: Load average is too high
    event_name: Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN}
      for 5m)
    opdata: 'Load averages(1m 5m 15m): ({ITEM.LASTVALUE1} {ITEM.LASTVALUE3} {ITEM.LASTVALUE4}),
      # of CPUs: {ITEM.LASTVALUE2}'
    priority: AVERAGE
    description: The load average per CPU is too high. The system may be slow to respond.
    tags:
    - tag: scope
      value: capacity
    - tag: scope
      value: performance
  graphs:
  - uuid: d6f807a2c232406da5eb8da25ea5072d
    name: 'Linux: CPU jumps'
    graph_items:
    - color: 199C0D
      item:
        host: Vsat by SNMP
        key: system.cpu.switches[ssRawContexts.0]
    - sortorder: '1'
      color: F63100
      item:
        host: Vsat by SNMP
        key: system.cpu.intr[ssRawInterrupts.0]
  - uuid: b885116a61654c4183a121a83aa40017
    name: 'Linux: Memory usage'
    ymin_type_1: FIXED
    graph_items:
    - drawtype: BOLD_LINE
      color: 199C0D
      item:
        host: Vsat by SNMP
        key: vm.memory.total[memTotalReal.0]
    - sortorder: '1'
      drawtype: GRADIENT_LINE
      color: F63100
      item:
        host: Vsat by SNMP
        key: vm.memory.available[snmp]
  - uuid: 3cd9374bea15432cb2b5071df493d016
    name: 'Linux: Memory utilization'
    ymin_type_1: FIXED
    ymax_type_1: FIXED
    graph_items:
    - drawtype: GRADIENT_LINE
      color: 199C0D
      item:
        host: Vsat by SNMP
        key: vm.memory.util[snmp]
  - uuid: 7451f0b87b014934a646e158d9dccb6e
    name: 'Linux: Swap usage'
    graph_items:
    - color: 199C0D
      item:
        host: Vsat by SNMP
        key: system.swap.free[memAvailSwap.0]
    - sortorder: '1'
      color: F63100
      item:
        host: Vsat by SNMP
        key: system.swap.total[memTotalSwap.0]
  - uuid: c29995bf2eb2494394ac66f7183b6c41
    name: 'Linux: System load'
    ymin_type_1: FIXED
    graph_items:
    - color: 199C0D
      item:
        host: Vsat by SNMP
        key: system.cpu.load.avg1[laLoad.1]
    - sortorder: '1'
      color: F63100
      item:
        host: Vsat by SNMP
        key: system.cpu.load.avg5[laLoad.2]
    - sortorder: '2'
      color: 00611C
      item:
        host: Vsat by SNMP
        key: system.cpu.load.avg15[laLoad.3]
    - sortorder: '3'
      color: F7941D
      yaxisside: RIGHT
      item:
        host: Vsat by SNMP
        key: system.cpu.num[snmp]
